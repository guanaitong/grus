<!doctype html><html lang=zh class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Create a static site from a set of Markdown files to host the documentation of Java"><meta name=author content="August Zhou"><link href=https://java.guide.wuxingdev.cn/grus/data/mybatis-pagehelper/ rel=canonical><link rel=icon href=../../../assets/favicon.ico><meta name=generator content="mkdocs-1.2.3, mkdocs-material-7.3.6"><title>Mybatis分页插件 - Java Guide</title><link rel=stylesheet href=../../../assets/stylesheets/main.a57b2b03.min.css><link rel=stylesheet href=../../../assets/stylesheets/palette.3f5d1f46.min.css><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback"><style>:root{--md-text-font-family:"Roboto";--md-code-font-family:"Roboto Mono"}</style></head> <body dir=ltr data-md-color-scheme=default data-md-color-primary=indigo data-md-color-accent=indigo> <script>function __prefix(e){return new URL("../../..",location).pathname+"."+e}function __get(e,t=localStorage){return JSON.parse(t.getItem(__prefix(e)))}</script> <script>var palette=__get("__palette");if(null!==palette&&"object"==typeof palette.color)for(var key in palette.color)document.body.setAttribute("data-md-color-"+key,palette.color[key])</script> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#mybatis class=md-skip> 跳转至 </a> </div> <div data-md-component=announce> </div> <header class=md-header data-md-component=header> <nav class="md-header__inner md-grid" aria-label=Header> <a href=../../.. title="Java Guide" class="md-header__button md-logo" aria-label="Java Guide" data-md-component=logo> <img src=../../../assets/logo.png alt=logo> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> Java Guide </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> Mybatis分页插件 </span> </div> </div> </div> <form class=md-header__option data-md-component=palette> <input class=md-option data-md-color-media data-md-color-scheme=default data-md-color-primary=indigo data-md-color-accent=indigo aria-label="Switch to dark mode" type=radio name=__palette id=__palette_1> <label class="md-header__button md-icon" title="Switch to dark mode" for=__palette_2 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6zm0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4zM7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"/></svg> </label> <input class=md-option data-md-color-media data-md-color-scheme=slate data-md-color-primary=red data-md-color-accent=red aria-label="Switch to light mode" type=radio name=__palette id=__palette_2> <label class="md-header__button md-icon" title="Switch to light mode" for=__palette_1 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3z"/></svg> </label> </form> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=搜索 placeholder=搜索 autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg> </label> <nav class=md-search__options aria-label=Search> <a href=javascript:void(0) class="md-search__icon md-icon" aria-label=Share data-clipboard data-clipboard-text data-md-component=search-share tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7 0-.24-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91 1.61 0 2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08z"/></svg> </a> <button type=reset class="md-search__icon md-icon" aria-label=Clear tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg> </button> </nav> <div class=md-search__suggest data-md-component=search-suggest></div> </form> <div class=md-search__output> <div class=md-search__scrollwrap data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> 正在初始化搜索引擎 </div> <ol class=md-search-result__list></ol> </div> </div> </div> </div> </div> <div class=md-header__source> <a href=https://gitlab.wuxingdev.cn/java/framework/grus title=前往仓库 class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg> </div> <div class=md-source__repository> java/framework/grus </div> </a> </div> </nav> </header> <div class=md-container data-md-component=container> <nav class=md-tabs aria-label=Tabs data-md-component=tabs> <div class="md-tabs__inner md-grid"> <ul class=md-tabs__list> <li class=md-tabs__item> <a href=../../.. class=md-tabs__link> 首页 </a> </li> <li class=md-tabs__item> <a href=../../../prepare/contribute/manage/ class=md-tabs__link> 序言 </a> </li> <li class=md-tabs__item> <a href=../../introduction/origin/ class="md-tabs__link md-tabs__link--active"> grus框架 </a> </li> <li class=md-tabs__item> <a href=../../../others/develop-guide/ class=md-tabs__link> 其他 </a> </li> </ul> </div> </nav> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary md-nav--lifted" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=../../.. title="Java Guide" class="md-nav__button md-logo" aria-label="Java Guide" data-md-component=logo> <img src=../../../assets/logo.png alt=logo> </a> Java Guide </label> <div class=md-nav__source> <a href=https://gitlab.wuxingdev.cn/java/framework/grus title=前往仓库 class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg> </div> <div class=md-source__repository> java/framework/grus </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_1 type=checkbox id=__nav_1> <div class="md-nav__link md-nav__link--index "> <a href=../../..>首页</a> </div> <nav class=md-nav aria-label=首页 data-md-level=1> <label class=md-nav__title for=__nav_1> <span class="md-nav__icon md-icon"></span> 首页 </label> <ul class=md-nav__list data-md-scrollfix> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2 type=checkbox id=__nav_2> <label class=md-nav__link for=__nav_2> 序言 <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=序言 data-md-level=1> <label class=md-nav__title for=__nav_2> <span class="md-nav__icon md-icon"></span> 序言 </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../prepare/contribute/manage/ class=md-nav__link> 开发管理 </a> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_2 type=checkbox id=__nav_2_2> <label class=md-nav__link for=__nav_2_2> 环境安装 <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=环境安装 data-md-level=2> <label class=md-nav__title for=__nav_2_2> <span class="md-nav__icon md-icon"></span> 环境安装 </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../prepare/develop-env/java-install/ class=md-nav__link> Java安装 </a> </li> <li class=md-nav__item> <a href=../../../prepare/develop-env/maven-install/ class=md-nav__link> Maven安装 </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_3 type=checkbox id=__nav_2_3> <label class=md-nav__link for=__nav_2_3> 规范 <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=规范 data-md-level=2> <label class=md-nav__title for=__nav_2_3> <span class="md-nav__icon md-icon"></span> 规范 </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../prepare/specs/maven/ class=md-nav__link> Maven规范 </a> </li> <li class=md-nav__item> <a href=../../../prepare/specs/app-framework-spec/ class=md-nav__link> 项目规范 </a> </li> <li class=md-nav__item> <a href=../../../prepare/specs/jdbc-pool-config/ class=md-nav__link> 连接池规范 </a> </li> <li class=md-nav__item> <a href=../../../prepare/specs/app-log/ class=md-nav__link> 日志规范 </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_4 type=checkbox id=__nav_2_4> <label class=md-nav__link for=__nav_2_4> 技巧 <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=技巧 data-md-level=2> <label class=md-nav__title for=__nav_2_4> <span class="md-nav__icon md-icon"></span> 技巧 </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../prepare/skill/LearningIdea/ class=md-nav__link> IDEA使用技巧 </a> </li> <li class=md-nav__item> <a href=../../../prepare/skill/sonar/ class=md-nav__link> Sonarlint配置指南 </a> </li> <li class=md-nav__item> <a href=../../../prepare/skill/checkstyle/ class=md-nav__link> Checksyle配置 </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3 type=checkbox id=__nav_3 checked> <label class=md-nav__link for=__nav_3> grus框架 <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=grus框架 data-md-level=1> <label class=md-nav__title for=__nav_3> <span class="md-nav__icon md-icon"></span> grus框架 </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../introduction/origin/ class=md-nav__link> 简介 </a> </li> <li class=md-nav__item> <a href=../../introduction/project-structure/ class=md-nav__link> 项目结构 </a> </li> <li class=md-nav__item> <a href=../../introduction/project-starter/ class=md-nav__link> Starter模块 </a> </li> <li class=md-nav__item> <a href=../../introduction/autoconfigure/ class=md-nav__link> Autoconfigure模块 </a> </li> <li class=md-nav__item> <a href=../../introduction/condition/ class=md-nav__link> Condition条件注解 </a> </li> <li class=md-nav__item> <a href=../../introduction/config/ class=md-nav__link> 配置文件 </a> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3_7 type=checkbox id=__nav_3_7> <div class="md-nav__link md-nav__link--index "> <a href=../../gconf/ >Gconf</a> </div> <nav class=md-nav aria-label=Gconf data-md-level=2> <label class=md-nav__title for=__nav_3_7> <span class="md-nav__icon md-icon"></span> Gconf </label> <ul class=md-nav__list data-md-scrollfix> </ul> </nav> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3_8 type=checkbox id=__nav_3_8> <div class="md-nav__link md-nav__link--index "> <a href=../../api/ >巨灵神规范</a> <label for=__nav_3_8> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav aria-label=巨灵神规范 data-md-level=2> <label class=md-nav__title for=__nav_3_8> <span class="md-nav__icon md-icon"></span> 巨灵神规范 </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../api/grus-feign-use/ class=md-nav__link> feign </a> </li> <li class=md-nav__item> <a href=../../api/grus-feign-guide/ class=md-nav__link> 使用指南 </a> </li> <li class=md-nav__item> <a href=../../api/grus-feign-best-practice/ class=md-nav__link> 最佳实践 </a> </li> <li class=md-nav__item> <a href=../../api/grus-feign-contract/ class=md-nav__link> Feign协议升级 </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3_9 type=checkbox id=__nav_3_9 checked> <div class="md-nav__link md-nav__link--index "> <a href=../ >data</a> <label for=__nav_3_9> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav aria-label=data data-md-level=2> <label class=md-nav__title for=__nav_3_9> <span class="md-nav__icon md-icon"></span> data </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" data-md-toggle=toc type=checkbox id=__toc> <label class="md-nav__link md-nav__link--active" for=__toc> Mybatis分页插件 <span class="md-nav__icon md-icon"></span> </label> <a href=./ class="md-nav__link md-nav__link--active"> Mybatis分页插件 </a> <nav class="md-nav md-nav--secondary" aria-label=目录> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> 目录 </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#_1 class=md-nav__link> 目的 </a> </li> <li class=md-nav__item> <a href=#_2 class=md-nav__link> 使用需知 </a> <nav class=md-nav aria-label=使用需知> <ul class=md-nav__list> <li class=md-nav__item> <a href=#_3 class=md-nav__link> 如何禁用 </a> </li> <li class=md-nav__item> <a href=#_4 class=md-nav__link> 配置参数差异化对比 </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#_5 class=md-nav__link> 简单使用示例 </a> <nav class=md-nav aria-label=简单使用示例> <ul class=md-nav__list> <li class=md-nav__item> <a href=#lambda class=md-nav__link> Lambda 写法（推荐） </a> <nav class=md-nav aria-label="Lambda 写法（推荐）"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#setorderby class=md-nav__link> setOrderBy </a> </li> <li class=md-nav__item> <a href=#count class=md-nav__link> 手写 count 查询 </a> </li> <li class=md-nav__item> <a href=#reasonable class=md-nav__link> Reasonable </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#_6 class=md-nav__link> 参数方法/对象调用 </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#_7 class=md-nav__link> 注意事项 </a> <nav class=md-nav aria-label=注意事项> <ul class=md-nav__list> <li class=md-nav__item> <a href=#_8 class=md-nav__link> 参数调用注意 </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../mybatis-enhance/ class=md-nav__link> Mybatis增加 </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3_10 type=checkbox id=__nav_3_10> <div class="md-nav__link md-nav__link--index "> <a href=../../redis/ >redis</a> </div> <nav class=md-nav aria-label=redis data-md-level=2> <label class=md-nav__title for=__nav_3_10> <span class="md-nav__icon md-icon"></span> redis </label> <ul class=md-nav__list data-md-scrollfix> </ul> </nav> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3_11 type=checkbox id=__nav_3_11> <div class="md-nav__link md-nav__link--index "> <a href=../../zk/ >zookeeper</a> </div> <nav class=md-nav aria-label=zookeeper data-md-level=2> <label class=md-nav__title for=__nav_3_11> <span class="md-nav__icon md-icon"></span> zookeeper </label> <ul class=md-nav__list data-md-scrollfix> </ul> </nav> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3_12 type=checkbox id=__nav_3_12> <div class="md-nav__link md-nav__link--index "> <a href=../../kafka/ >kafka</a> </div> <nav class=md-nav aria-label=kafka data-md-level=2> <label class=md-nav__title for=__nav_3_12> <span class="md-nav__icon md-icon"></span> kafka </label> <ul class=md-nav__list data-md-scrollfix> </ul> </nav> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3_13 type=checkbox id=__nav_3_13> <div class="md-nav__link md-nav__link--index "> <a href=../../web/ >web</a> <label for=__nav_3_13> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav aria-label=web data-md-level=2> <label class=md-nav__title for=__nav_3_13> <span class="md-nav__icon md-icon"></span> web </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../web/grus-validator/ class=md-nav__link> Validator模块 </a> </li> <li class=md-nav__item> <a href=../../web/grus-swagger/ class=md-nav__link> Swagger使用说明 </a> </li> <li class=md-nav__item> <a href=../../web/grus-freemarker/ class=md-nav__link> Freemarker使用说明 </a> </li> <li class=md-nav__item> <a href=../../web/grus-velocity/ class=md-nav__link> Velocity使用说明 </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3_14 type=checkbox id=__nav_3_14> <div class="md-nav__link md-nav__link--index "> <a href=../../job/ >job</a> <label for=__nav_3_14> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav aria-label=job data-md-level=2> <label class=md-nav__title for=__nav_3_14> <span class="md-nav__icon md-icon"></span> job </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../job/elasticjob/ class=md-nav__link> ElasticJob介绍 </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3_15 type=checkbox id=__nav_3_15> <div class="md-nav__link md-nav__link--index "> <a href=../../test/ >单元测试</a> </div> <nav class=md-nav aria-label=单元测试 data-md-level=2> <label class=md-nav__title for=__nav_3_15> <span class="md-nav__icon md-icon"></span> 单元测试 </label> <ul class=md-nav__list data-md-scrollfix> </ul> </nav> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3_16 type=checkbox id=__nav_3_16> <div class="md-nav__link md-nav__link--index "> <a href=../../limit/ >微服务流量控制</a> </div> <nav class=md-nav aria-label=微服务流量控制 data-md-level=2> <label class=md-nav__title for=__nav_3_16> <span class="md-nav__icon md-icon"></span> 微服务流量控制 </label> <ul class=md-nav__list data-md-scrollfix> </ul> </nav> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3_17 type=checkbox id=__nav_3_17> <div class="md-nav__link md-nav__link--index "> <a href=../../session/ >分布式session</a> </div> <nav class=md-nav aria-label=分布式session data-md-level=2> <label class=md-nav__title for=__nav_3_17> <span class="md-nav__icon md-icon"></span> 分布式session </label> <ul class=md-nav__list data-md-scrollfix> </ul> </nav> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3_18 type=checkbox id=__nav_3_18> <div class="md-nav__link md-nav__link--index "> <a href=../../gfs/ >分布式存储gfs</a> <label for=__nav_3_18> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav aria-label=分布式存储gfs data-md-level=2> <label class=md-nav__title for=__nav_3_18> <span class="md-nav__icon md-icon"></span> 分布式存储gfs </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../gfs/gfs-sdk/ class=md-nav__link> gfs-client使用说明 </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3_19 type=checkbox id=__nav_3_19> <div class="md-nav__link md-nav__link--index "> <a href=../../frigate/ >frigate消息</a> <label for=__nav_3_19> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav aria-label=frigate消息 data-md-level=2> <label class=md-nav__title for=__nav_3_19> <span class="md-nav__icon md-icon"></span> frigate消息 </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../frigate/grus-frigate-message-handle/ class=md-nav__link> gfs-client使用说明 </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3_20 type=checkbox id=__nav_3_20> <div class="md-nav__link md-nav__link--index "> <a href=../../others/ >others</a> <label for=__nav_3_20> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav aria-label=others data-md-level=2> <label class=md-nav__title for=__nav_3_20> <span class="md-nav__icon md-icon"></span> others </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../others/grus-core/ class=md-nav__link> bean复制工具 </a> </li> <li class=md-nav__item> <a href=../../others/grus-json/ class=md-nav__link> JSON使用说明 </a> </li> <li class=md-nav__item> <a href=../../others/grus-17/ class=md-nav__link> Java17升级指南 </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_4 type=checkbox id=__nav_4> <label class=md-nav__link for=__nav_4> 其他 <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=其他 data-md-level=1> <label class=md-nav__title for=__nav_4> <span class="md-nav__icon md-icon"></span> 其他 </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../others/develop-guide/ class=md-nav__link> 应用开发指南 </a> </li> <li class=md-nav__item> <a href=../../../others/security-base/ class=md-nav__link> 安全基础 </a> </li> <li class=md-nav__item> <a href=../../../others/short-url/ class=md-nav__link> 短链接 </a> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=sidebar data-md-type=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary" aria-label=目录> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> 目录 </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#_1 class=md-nav__link> 目的 </a> </li> <li class=md-nav__item> <a href=#_2 class=md-nav__link> 使用需知 </a> <nav class=md-nav aria-label=使用需知> <ul class=md-nav__list> <li class=md-nav__item> <a href=#_3 class=md-nav__link> 如何禁用 </a> </li> <li class=md-nav__item> <a href=#_4 class=md-nav__link> 配置参数差异化对比 </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#_5 class=md-nav__link> 简单使用示例 </a> <nav class=md-nav aria-label=简单使用示例> <ul class=md-nav__list> <li class=md-nav__item> <a href=#lambda class=md-nav__link> Lambda 写法（推荐） </a> <nav class=md-nav aria-label="Lambda 写法（推荐）"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#setorderby class=md-nav__link> setOrderBy </a> </li> <li class=md-nav__item> <a href=#count class=md-nav__link> 手写 count 查询 </a> </li> <li class=md-nav__item> <a href=#reasonable class=md-nav__link> Reasonable </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#_6 class=md-nav__link> 参数方法/对象调用 </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#_7 class=md-nav__link> 注意事项 </a> <nav class=md-nav aria-label=注意事项> <ul class=md-nav__list> <li class=md-nav__item> <a href=#_8 class=md-nav__link> 参数调用注意 </a> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <h1 id=mybatis>Mybatis 分页插件<a class=headerlink href=#mybatis title="Permanent link">&para;</a></h1> <h2 id=_1>目的<a class=headerlink href=#_1 title="Permanent link">&para;</a></h2> <p><code>grus</code> 框架对 <code>mybatis</code> 分页提供了统一的解决方案，基于 <code>PageHelper</code>，<code>GAV</code> 如下，默认**引入则启用**。</p> <div class=highlight><pre><span></span><code><span class=nt>&lt;dependency&gt;</span>
    <span class=nt>&lt;artifactId&gt;</span>grus-boot-starter-pagehelper<span class=nt>&lt;/artifactId&gt;</span>
    <span class=nt>&lt;groupId&gt;</span>com.ciicgat.grus.boot<span class=nt>&lt;/groupId&gt;</span>
<span class=nt>&lt;/dependency&gt;</span>
</code></pre></div> <blockquote> <p>常用的 <code>grus-boot-starter-server-service</code> 已引入上面的 <code>GAV</code>，自动启用，无需再引入。</p> </blockquote> <h2 id=_2>使用需知<a class=headerlink href=#_2 title="Permanent link">&para;</a></h2> <ul> <li>分页插件 PageHelper 介绍 <a href=https://github.com/pagehelper/Mybatis-PageHelper>传送门</a>。</li> <li>PageHelper 使用说明 <a href=https://github.com/pagehelper/Mybatis-PageHelper/blob/master/wikis/zh/HowToUse.md>如何使用</a>。</li> <li>PageHelper 安全调用 <a href=https://github.com/pagehelper/Mybatis-PageHelper/blob/master/wikis/zh/HowToUse.md#3-pagehelper-%E5%AE%89%E5%85%A8%E8%B0%83%E7%94%A8>传送门</a></li> </ul> <h3 id=_3>如何禁用<a class=headerlink href=#_3 title="Permanent link">&para;</a></h3> <p>如果项目中已经使用了 PageHelper 插件，与 <code>GrusPageHelperAutoConfiguration</code> 中自动注入的 <code>PageInterceptor</code> 冲突，或者因 <code>PageInterceptor</code> 插件引入导致某些正常查询报错，可以通过配置关闭，如下：</p> <div class=highlight><pre><span></span><code><span class=na>grus.pagehelper.enabled</span><span class=o>=</span><span class=s>false</span>
</code></pre></div> <h3 id=_4>配置参数差异化对比<a class=headerlink href=#_4 title="Permanent link">&para;</a></h3> <blockquote> <p><a href=https://github.com/pagehelper/Mybatis-PageHelper/blob/master/wikis/zh/HowToUse.md>PageHelper 插件</a> 参数全部相同，前缀不同，个别参数默认值不同。</p> </blockquote> <table> <thead> <tr> <th></th> <th>PageHelper</th> <th>Grus-PageHelper</th> </tr> </thead> <tbody> <tr> <td>参数前缀</td> <td>pagehelper</td> <td>grus.pagehelper</td> </tr> <tr> <td><code>helperDialect</code></td> <td>自动检测</td> <td>mysql</td> </tr> <tr> <td><code>supportMethodsArguments</code></td> <td>false</td> <td>true</td> </tr> <tr> <td><code>autoRuntimeDialect</code></td> <td>false</td> <td>true</td> </tr> </tbody> </table> <ul> <li><code>helperDialect</code></li> </ul> <p>分页插件会自动检测当前的数据库链接，选择合适的分页方式。 你可以通过配置来指定分页插件使用哪种方言。配置时，可以使用下面的缩写值：<code>oracle</code>,<code>mysql</code>,<code>mariadb</code>,<code>sqlite</code>,<code>hsqldb</code>,<code>postgresql</code>,<code>db2</code>,<code>sqlserver</code>,<code>informix</code>,<code>h2</code>,<code>sqlserver2012</code>,<code>derby</code></p> <ul> <li><code>supportMethodsArguments</code></li> </ul> <p>支持通过 Mapper 接口参数来传递分页参数，默认值 <code>false</code>，分页插件会从查询方法的参数值中，自动根据 <code>params</code>（PageHelper 中的一个配置） 取值，查找到合适的值时就会参与分页。可以配置 <code>pageNum,pageSize,count,pageSizeZero,reasonable</code>，默认值为<code>pageNum=pageNum;pageSize=pageSize;count=countSql;reasonable=reasonable;pageSizeZero=pageSizeZero</code></p> <ul> <li><code>autoRuntimeDialect</code></li> </ul> <p>设置为 <code>true</code> 时，允许在运行时根据多数据源自动识别对应方言的分页 （不支持自动选择<code>sqlserver2012</code>，只能使用<code>sqlserver</code>）</p> <h2 id=_5>简单使用示例<a class=headerlink href=#_5 title="Permanent link">&para;</a></h2> <h3 id=lambda>Lambda 写法（推荐）<a class=headerlink href=#lambda title="Permanent link">&para;</a></h3> <blockquote> <p>这里只讲解推荐的写法，另外的方式请参考官方文档</p> </blockquote> <div class=highlight><pre><span></span><code><span class=n>Page</span><span class=o>&lt;</span><span class=n>User</span><span class=o>&gt;</span> <span class=n>page</span> <span class=o>=</span> <span class=n>PageHelper</span><span class=p>.</span><span class=na>startPage</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=mi>10</span><span class=p>).</span><span class=na>doSelectPage</span><span class=p>(()</span><span class=o>-&gt;</span> <span class=n>userMapper</span><span class=p>.</span><span class=na>selectGroupBy</span><span class=p>());</span>
<span class=c1>// 总数量</span>
<span class=kt>long</span> <span class=n>totalCount</span> <span class=o>=</span> <span class=n>page</span><span class=p>.</span><span class=na>getTotal</span><span class=p>();</span>
<span class=n>List</span><span class=o>&lt;</span><span class=n>User</span><span class=o>&gt;</span> <span class=n>userList</span> <span class=o>=</span> <span class=n>page</span><span class=p>.</span><span class=na>getList</span><span class=p>();</span>

<span class=c1>// count 查询，返回一个查询语句的 count 数，注意不要有牵扯到数量的 order by</span>
<span class=n>total</span> <span class=o>=</span> <span class=n>PageHelper</span><span class=p>.</span><span class=na>count</span><span class=p>(()</span><span class=o>-&gt;</span><span class=n>userMapper</span><span class=p>.</span><span class=na>selectLike</span><span class=p>(</span><span class=n>user</span><span class=p>));</span>

<span class=c1>// 紧跟在 PageHelper.startPage 方法后的第一个 Mybatis 的查询（Select）方法会被分页</span>
<span class=c1>// 这种方法也可以，但更推荐上面的那种，从 list 获取分页对象的方式见后面</span>
<span class=n>PageHelper</span><span class=p>.</span><span class=na>startPage</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=mi>10</span><span class=p>);</span>
<span class=n>List</span><span class=o>&lt;</span><span class=n>User</span><span class=o>&gt;</span> <span class=n>list</span> <span class=o>=</span> <span class=n>userMapper</span><span class=p>.</span><span class=na>selectIf</span><span class=p>(</span><span class=mi>1</span><span class=p>);</span>
</code></pre></div> <blockquote> <p>count 查询，返回一个查询语句的 count 数，注意不要有牵扯到数量的 order by，PageHelper 会自动过滤掉 order by 的条件，详情见下文的 <a href="#手写 count 查询">手写 count 查询</a></p> </blockquote> <p>正常我们用不到 Page 中那么多参数，建议写成如下形式：</p> <div class=highlight><pre><span></span><code><span class=n>PageSerializable</span><span class=o>&lt;</span><span class=n>User</span><span class=o>&gt;</span> <span class=n>page</span> <span class=o>=</span> <span class=n>PageHelper</span><span class=p>.</span><span class=na>startPage</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=mi>10</span><span class=p>).</span><span class=na>doSelectPageSerializable</span><span class=p>(()</span><span class=o>-&gt;</span> <span class=n>userMapper</span><span class=p>.</span><span class=na>selectGroupBy</span><span class=p>());</span>
<span class=kt>long</span> <span class=n>totalCount</span> <span class=o>=</span> <span class=n>page</span><span class=p>.</span><span class=na>getTotal</span><span class=p>();</span>
<span class=n>List</span><span class=o>&lt;</span><span class=n>User</span><span class=o>&gt;</span> <span class=n>userList</span> <span class=o>=</span> <span class=n>page</span><span class=p>.</span><span class=na>getList</span><span class=p>();</span>
</code></pre></div> <h4 id=setorderby>setOrderBy<a class=headerlink href=#setorderby title="Permanent link">&para;</a></h4> <p>支持自动拼接 order by，此时 sql.xml 中不应该有 order by 内容，写法如下：</p> <div class=highlight><pre><span></span><code><span class=n>PageSerializable</span><span class=o>&lt;</span><span class=n>User</span><span class=o>&gt;</span> <span class=n>page</span> <span class=o>=</span> <span class=n>PageHelper</span><span class=p>.</span><span class=na>startPage</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=mi>10</span><span class=p>).</span><span class=na>setOrderBy</span><span class=p>(</span><span class=s>&quot;id desc&quot;</span><span class=p>).</span><span class=na>doSelectPageSerializable</span><span class=p>(()</span><span class=o>-&gt;</span> <span class=n>userMapper</span><span class=p>.</span><span class=na>selectGroupBy</span><span class=p>());</span>
</code></pre></div> <h4 id=count><a name="手写 count 查询">手写 count 查询</a><a class=headerlink href=#count title="Permanent link">&para;</a></h4> <blockquote> <p>PageHelper 默认的 count 查询，会忽略掉 order by，针对某些特殊业务的统计，有可能会产生问题。使用时，请一定要注意！！！</p> </blockquote> <p>某些业务场景，分页时，希望手写 count 的 sql（提高性能） 或者 sql 中有影响行数统计的 order by（PageHelper count 查询时会自动过滤 order by 查询条件），会影响统计的总行数，PageHelper 提供了两种方式解决这个问题。</p> <p><strong>手写 count sql（推荐）</strong></p> <p>这时候，只需要在 sql.xml 中添加该 msId 对应的 count 写法即可。分页插件会优先通过当前查询的 msId + <code>countSuffix</code> 查找手写的分页查询。（<code>countSuffix</code> 默认为 <code>_COUNT</code>）示例如下：</p> <div class=highlight><pre><span></span><code><span class=nt>&lt;select</span> <span class=na>id=</span><span class=s>&quot;selectLeftjoin&quot;</span> <span class=na>resultType=</span><span class=s>&quot;com.github.pagehelper.model.User&quot;</span><span class=nt>&gt;</span>
    select a.id,b.name,a.py from user a
    left join user b on a.id = b.id
    order by a.id
<span class=nt>&lt;/select&gt;</span>
<span class=nt>&lt;select</span> <span class=na>id=</span><span class=s>&quot;selectLeftjoin_COUNT&quot;</span> <span class=na>resultType=</span><span class=s>&quot;Long&quot;</span><span class=nt>&gt;</span>
    select count(distinct a.id) from user a
    left join user b on a.id = b.id
<span class=nt>&lt;/select&gt;</span>
</code></pre></div> <p><strong>sql 添加标记</strong></p> <div class=highlight><pre><span></span><code>    <span class=k>select</span> <span class=n>a</span><span class=p>.</span><span class=n>id</span><span class=p>,</span><span class=n>b</span><span class=p>.</span><span class=n>name</span><span class=p>,</span><span class=n>a</span><span class=p>.</span><span class=n>py</span> <span class=k>from</span> <span class=k>user</span> <span class=n>a</span>
    <span class=k>left</span> <span class=k>join</span> <span class=k>user</span> <span class=n>b</span> <span class=k>on</span> <span class=n>a</span><span class=p>.</span><span class=n>id</span> <span class=o>=</span> <span class=n>b</span><span class=p>.</span><span class=n>id</span>
    <span class=cm>/*keep orderby*/</span><span class=k>order</span> <span class=k>by</span> <span class=n>a</span><span class=p>.</span><span class=n>id</span>
</code></pre></div> <blockquote> <p>将 <code>/*keep orderby*/</code> 加在需要 orderby 条件的前面</p> </blockquote> <h4 id=reasonable>Reasonable<a class=headerlink href=#reasonable title="Permanent link">&para;</a></h4> <p>有些场景希望分页查询时，希望 <code>pageNum&lt;=0</code> 时会查询第一页， <code>pageNum&gt;pages</code>（超过总数时），会默认查询最后一页。可通过如下方式实现：</p> <div class=highlight><pre><span></span><code><span class=n>PageInfo</span><span class=o>&lt;</span><span class=n>Object</span><span class=o>&gt;</span> <span class=n>pageInfo</span> <span class=o>=</span> <span class=n>PageHelper</span><span class=p>.</span><span class=na>startPage</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=mi>10</span><span class=p>).</span><span class=na>setReasonable</span><span class=p>(</span><span class=kc>true</span><span class=p>).</span><span class=na>doSelectPageInfo</span><span class=p>(()</span> <span class=o>-&gt;</span> <span class=n>exchangeRecordMapper</span><span class=p>.</span><span class=na>findByEnterprise</span><span class=p>(</span><span class=n>copy</span><span class=p>));</span>
<span class=c1>// 实际页码</span>
<span class=kt>int</span> <span class=n>pageNum</span> <span class=o>=</span> <span class=n>pageInfo</span><span class=p>.</span><span class=na>getPageNum</span><span class=p>();</span>
<span class=c1>// 实际页数</span>
<span class=kt>int</span> <span class=n>pages</span> <span class=o>=</span> <span class=n>pageInfo</span><span class=p>.</span><span class=na>getPages</span><span class=p>();</span>
</code></pre></div> <p>除了指定某个语句外，也支持统一配置（不推荐）：</p> <div class=highlight><pre><span></span><code><span class=na>grus.pagehelper.reasonable</span><span class=o>=</span><span class=s>true</span>
</code></pre></div> <h3 id=_6>参数方法/对象调用<a class=headerlink href=#_6 title="Permanent link">&para;</a></h3> <p><code>grus.pagehelper.supportMethodsArguments=true</code> 时，该写法才可以生效（前面的写法不依赖此配置）。</p> <blockquote> <p>并不推荐这种方式，除了需要更多的配置外，还容易产生一些使用不当的问题，这里只是简单罗列下有这种方式，给仍用这种方式的项目提供下 demo。</p> </blockquote> <ul> <li>参数方法调用，存在以下 Mapper 接口方法，你不需要在 xml 处理后两个参数</li> </ul> <div class=highlight><pre><span></span><code><span class=c1>//存在以下 Mapper 接口方法，你不需要在 xml 处理后两个参数</span>
<span class=kd>public</span> <span class=kd>interface</span> <span class=nc>CountryMapper</span> <span class=p>{</span>
    <span class=n>List</span><span class=o>&lt;</span><span class=n>User</span><span class=o>&gt;</span> <span class=nf>selectByPageNumSize</span><span class=p>(</span>
            <span class=nd>@Param</span><span class=p>(</span><span class=s>&quot;user&quot;</span><span class=p>)</span> <span class=n>User</span> <span class=n>user</span><span class=p>,</span>
            <span class=nd>@Param</span><span class=p>(</span><span class=s>&quot;pageNum&quot;</span><span class=p>)</span> <span class=kt>int</span> <span class=n>pageNum</span><span class=p>,</span>
            <span class=nd>@Param</span><span class=p>(</span><span class=s>&quot;pageSize&quot;</span><span class=p>)</span> <span class=kt>int</span> <span class=n>pageSize</span><span class=p>);</span>
<span class=p>}</span>
<span class=c1>//配置 supportMethodsArguments=true</span>
<span class=c1>//在代码中直接调用：</span>
<span class=n>List</span><span class=o>&lt;</span><span class=n>User</span><span class=o>&gt;</span> <span class=n>list</span> <span class=o>=</span> <span class=n>userMapper</span><span class=p>.</span><span class=na>selectByPageNumSize</span><span class=p>(</span><span class=n>user</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>10</span><span class=p>);</span>
</code></pre></div> <ul> <li>参数对象，如果 pageNum 和 pageSize 存在于 查询参数 对象中，只要参数有值，也会被分页</li> </ul> <div class=highlight><pre><span></span><code><span class=c1>//如果 pageNum 和 pageSize 存在于 User 对象中，只要参数有值，也会被分页</span>
<span class=c1>//有如下 User 对象</span>
<span class=kd>public</span> <span class=kd>class</span> <span class=nc>User</span> <span class=p>{</span>
    <span class=c1>//其他fields</span>
    <span class=c1>//下面两个参数名和 params 配置的名字一致</span>
    <span class=kd>private</span> <span class=n>Integer</span> <span class=n>pageNum</span><span class=p>;</span>
    <span class=kd>private</span> <span class=n>Integer</span> <span class=n>pageSize</span><span class=p>;</span>
<span class=p>}</span>
<span class=c1>//存在以下 Mapper 接口方法，你不需要在 xml 处理后两个参数</span>
<span class=kd>public</span> <span class=kd>interface</span> <span class=nc>CountryMapper</span> <span class=p>{</span>
    <span class=n>List</span><span class=o>&lt;</span><span class=n>User</span><span class=o>&gt;</span> <span class=nf>selectByPageNumSize</span><span class=p>(</span><span class=n>User</span> <span class=n>user</span><span class=p>);</span>
<span class=p>}</span>
<span class=c1>//当 user 中的 pageNum!= null &amp;&amp; pageSize!= null 时，会自动分页</span>
<span class=n>List</span><span class=o>&lt;</span><span class=n>User</span><span class=o>&gt;</span> <span class=n>list</span> <span class=o>=</span> <span class=n>userMapper</span><span class=p>.</span><span class=na>selectByPageNumSize</span><span class=p>(</span><span class=n>user</span><span class=p>);</span>
</code></pre></div> <ul> <li>从 list 取分页对象</li> </ul> <div class=highlight><pre><span></span><code><span class=c1>//用PageInfo对结果进行包装</span>
<span class=n>PageInfo</span> <span class=n>page</span> <span class=o>=</span> <span class=k>new</span> <span class=n>PageInfo</span><span class=p>(</span><span class=n>list</span><span class=p>);</span>
<span class=c1>//测试PageInfo全部属性</span>
<span class=c1>//PageInfo包含了非常全面的分页属性</span>
<span class=n>assertEquals</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=n>page</span><span class=p>.</span><span class=na>getPageNum</span><span class=p>());</span>
<span class=n>assertEquals</span><span class=p>(</span><span class=mi>10</span><span class=p>,</span> <span class=n>page</span><span class=p>.</span><span class=na>getPageSize</span><span class=p>());</span>
<span class=n>assertEquals</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=n>page</span><span class=p>.</span><span class=na>getStartRow</span><span class=p>());</span>
<span class=n>assertEquals</span><span class=p>(</span><span class=mi>10</span><span class=p>,</span> <span class=n>page</span><span class=p>.</span><span class=na>getEndRow</span><span class=p>());</span>
<span class=n>assertEquals</span><span class=p>(</span><span class=mi>183</span><span class=p>,</span> <span class=n>page</span><span class=p>.</span><span class=na>getTotal</span><span class=p>());</span>
<span class=n>assertEquals</span><span class=p>(</span><span class=mi>19</span><span class=p>,</span> <span class=n>page</span><span class=p>.</span><span class=na>getPages</span><span class=p>());</span>
<span class=n>assertEquals</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=n>page</span><span class=p>.</span><span class=na>getFirstPage</span><span class=p>());</span>
<span class=n>assertEquals</span><span class=p>(</span><span class=mi>8</span><span class=p>,</span> <span class=n>page</span><span class=p>.</span><span class=na>getLastPage</span><span class=p>());</span>
<span class=n>assertEquals</span><span class=p>(</span><span class=kc>true</span><span class=p>,</span> <span class=n>page</span><span class=p>.</span><span class=na>isFirstPage</span><span class=p>());</span>
<span class=n>assertEquals</span><span class=p>(</span><span class=kc>false</span><span class=p>,</span> <span class=n>page</span><span class=p>.</span><span class=na>isLastPage</span><span class=p>());</span>
<span class=n>assertEquals</span><span class=p>(</span><span class=kc>false</span><span class=p>,</span> <span class=n>page</span><span class=p>.</span><span class=na>isHasPreviousPage</span><span class=p>());</span>
<span class=n>assertEquals</span><span class=p>(</span><span class=kc>true</span><span class=p>,</span> <span class=n>page</span><span class=p>.</span><span class=na>isHasNextPage</span><span class=p>());</span>
</code></pre></div> <blockquote> <p><code>@Param("pageNum") int pageNum</code> 中的命名可以根据 <code>grus.pagehelper.params</code> 配置，更多使用方式请参照 <a href=https://github.com/pagehelper/Mybatis-PageHelper/blob/master/wikis/zh/HowToUse.md>文档</a>。</p> </blockquote> <h2 id=_7>注意事项<a class=headerlink href=#_7 title="Permanent link">&para;</a></h2> <ul> <li><strong><code>PageHelper.startPage</code> 方法重要提示</strong></li> </ul> <p>只有紧跟在 <code>PageHelper.startPage</code> 方法后的<b>第一个</b> Mybatis 的<b>查询（Select）</b>方法会被分页。</p> <ul> <li><strong><code>PageHelper</code> 默认的 count 会去除 order by</strong></li> </ul> <p><code>PageHelper</code> 默认会去除自己写的 count 语句中的 order by 字段，有可能导致统计的总数不符。可以通过在 sql 语句中添加 <code>/*keep orderby*/</code> 注释解决该问题，或者通过手写 count 解决。</p> <ul> <li><strong>请不要配置多个分页插件</strong></li> </ul> <p>请不要在系统中配置多个分页插件(使用 Spring 时，<code>mybatis-config.xml</code>和<code>Spring&lt;bean&gt;</code>配置方式，请选择其中一种，不要同时配置多个分页插件)！</p> <ul> <li><strong>分页插件不支持带有<code>for update</code>语句的分页</strong></li> </ul> <p>对于带有<code>for update</code>的 sql，会抛出运行时异常，对于这样的 sql 建议手动分页，毕竟这样的 sql 需要重视。</p> <ul> <li><strong>分页插件不支持嵌套结果映射</strong></li> </ul> <p>由于嵌套结果方式会导致结果集被折叠，因此分页查询的结果在折叠后总数会减少，所以无法保证分页结果数量正确。</p> <h3 id=_8>参数调用注意<a class=headerlink href=#_8 title="Permanent link">&para;</a></h3> <ul> <li><strong>对象还有成员变量 orderBy</strong></li> </ul> <p>当参数对象中有成员变量<code>orderBy</code>，<code>PageInterceptor</code>插件会在拦截的过程中做拼接排序的操作，这样最终执行的 sql 最后面会多<code>order by xxx</code>。这是<code>PageInterceptor</code>插件提供的默认功能，可配合分页参数一起使用。</p> <p>由于<code>grus-boot-starter-server-service</code>默认依赖<code>grus-boot-starter-pagehelper</code>，这样就导致依赖<code>grus-boot-starter-server-service</code>就默认集成了分页功能，就会导致参数对象包含<code>orderBy</code>成员变量的查询方法报错。如果出现此情况，使用以下三种方法解决：</p> <ol> <li> <p>使用分页插件功能，修改 xml 里面的 sql</p> </li> <li> <p>配置<code>grus.pagehelper.enabled=false</code>，禁用<code>PageInterceptor</code>插件</p> </li> <li> <p>修改<code>orderBy</code>成员变量名为其他</p> </li> <li> <p><strong>配置参数重要提示</strong></p> </li> </ol> <p>当 <code>offsetAsPageNum=false</code> 的时候，由于 <code>PageNum</code> 问题，<code>RowBounds</code> 查询的时候 <code>reasonable</code> 会强制为 <code>false</code>。使用 <code>PageHelper.startPage</code> 方法不受影响。</p> </article> </div> </div> <a href=# class="md-top md-icon" data-md-component=top data-md-state=hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"/></svg> Back to top </a> </main> <footer class=md-footer> <nav class="md-footer__inner md-grid" aria-label=Footer> <a href=../ class="md-footer__link md-footer__link--prev" aria-label="上一页: 数据模块" rel=prev> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg> </div> <div class=md-footer__title> <div class=md-ellipsis> <span class=md-footer__direction> 上一页 </span> 数据模块 </div> </div> </a> <a href=../mybatis-enhance/ class="md-footer__link md-footer__link--next" aria-label="下一页: Mybatis增加" rel=next> <div class=md-footer__title> <div class=md-ellipsis> <span class=md-footer__direction> 下一页 </span> Mybatis增加 </div> </div> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg> </div> </a> </nav> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-footer-copyright> <div class=md-footer-copyright__highlight> Copyright &copy; 2016 - 2021 guanaitong </div> Made with <a href=https://squidfunk.github.io/mkdocs-material/ target=_blank rel=noopener> Material for MkDocs </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <script id=__config type=application/json>{"base": "../../..", "features": ["content.code.annotate", "navigation.indexes", "navigation.sections", "navigation.tabs", "navigation.top", "navigation.tracking", "search.highlight", "search.share", "search.suggest", null], "translations": {"clipboard.copy": "\u590d\u5236", "clipboard.copied": "\u5df2\u590d\u5236", "search.config.lang": "ja", "search.config.pipeline": "trimmer, stemmer", "search.config.separator": "[\\uff0c\\u3002]+", "search.placeholder": "\u641c\u7d22", "search.result.placeholder": "\u952e\u5165\u4ee5\u5f00\u59cb\u641c\u7d22", "search.result.none": "\u6ca1\u6709\u627e\u5230\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.one": "\u627e\u5230 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.other": "# \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing", "select.version.title": "Select version"}, "search": "../../../assets/javascripts/workers/search.fcfe8b6d.min.js", "version": null}</script> <script src=../../../assets/javascripts/bundle.b1047164.min.js></script> </body> </html>